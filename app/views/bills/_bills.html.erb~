<script type="text/javascript" charset="utf-8">
$(function() {
  new Highcharts.Chart({
            chart:{
              renderTo:"income_chart"
             },
            title: {
	      text:"Income by Day"
            },
            xAxis:{
 	      type:"datetime"
            },
            yAxis:{
              title:{ 
                    text:"Amount in Rupees"
                   }
           },
           series: [{
            pointInterval: <%= 1.day*1000 %>,
	    pointStart: <%= 1.week.ago.to_i*1000 %>,
	    //data: <%= (1.week.ago.to_date..Date.today).map{ |date| Bill.total_on(date).to_f}.inspect %>
            data: <%= income_chart_series(bills,1.week.ago) %>
          }]
   });
 });
</script>
<div id="income_chart" style="width:560px;height:300px;" onload="function" ></div>
<table class="table table-striped">
  <tr>
    
    <th>Code</th>
    <th>Customer Name</th>
    <th>Items</th>
    
    <th>Vatamt</th>
    <th>Amount</th>
    <th>Advance</th>
    <th>Balance</th>
    <th></th>
    <th></th>
    <th></th>
  </tr>

<% @bills.each do |bill| %>
  <tr>
    <td><%= bill.code %></td>
    <td><%= bill.customer_name %></td>
    <td><% bill.items.each do |f| %><%= f.product_name %>-<%= f.product_size1 %>&nbsp;<%= f.product_size2 %><br /><% end %></td>
    <td><%= bill.vat %></td>
    <td><%= bill.vatamt %></td>
    <td><%= bill.amount %></td>
    <td><%= bill.advance %></td>
    <td><%= bill.balance %></td>
    <td><%= link_to 'Show', bill %></td>
    <td><%= link_to 'Edit', edit_bill_path(bill) %></td>
    <td><%= link_to 'Destroy', bill, confirm: 'Are you sure?', method: :delete %></td>
  </tr>
<% end %>
</table>
<%= paginate @bills %>
